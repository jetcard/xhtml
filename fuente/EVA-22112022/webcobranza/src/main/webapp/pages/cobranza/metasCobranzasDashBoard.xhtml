<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="es_PE" 
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:f="http://java.sun.com/jsf/core">

    <ui:composition template="/resources/personal/plantillas/template.xhtml">
        <ui:define name="content">
            <!-- JS -->
            <!-- Mainly scripts -->
            <script src="../../resources/template/js/jquery-2.1.1.js"></script>
            <script src="../../resources/template/js/bootstrap.min.js"></script>
            <script src="../../resources/template/js/plugins/metisMenu/jquery.metisMenu.js"></script>
            <script src="../../resources/template/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

            <!-- Custom and plugin javascript -->
            <script src="../../resources/template/js/inspinia.js"></script>
            <script src="../../resources/template/js/plugins/pace/pace.min.js"></script>

            <!-- ChartJS-->
            <script src="../../resources/template/js/plugins/chartJs/Chart.min.js"></script>   
            <!-- grafico personal -->

            <!-- Chosen -->
            <script src="../../resources/template/js/plugins/chosen/chosen.jquery.js"></script>
            
            <!-- JSKnob -->
            <script src="../../resources/template/js/plugins/jsKnob/jquery.knob.js"></script>

            <!-- Input Mask-->
            <script src="../../resources/template/js/plugins/jasny/jasny-bootstrap.min.js"></script>
            
            <!-- Data picker -->
            <script src="../../resources/template/js/plugins/datapicker/bootstrap-datepicker.js"></script>

            <!-- NouSlider -->
            <script src="../../resources/template/js/plugins/nouslider/jquery.nouislider.min.js"></script>

            <!-- Switchery -->
            <script src="../../resources/template/js/plugins/switchery/switchery.js"></script>

            <!-- IonRangeSlider -->
            <script src="../../resources/template/js/plugins/ionRangeSlider/ion.rangeSlider.min.js"></script>

            <!-- MENU -->
            <script src="../../resources/template/js/plugins/metisMenu/jquery.metisMenu.js"></script>

            <!-- Date range use moment.js same as full calendar plugin -->
            <script src="../../resources/template/js/plugins/fullcalendar/moment.min.js"></script>

            <!-- Date range picker -->
            <script src="../../resources/template/js/plugins/daterangepicker/daterangepicker.js"></script>
            
            <!-- Select2 -->
            <script src="../../resources/template/js/plugins/select2/select2.full.min.js"></script>

            <!-- grafico personal -->
            <script src="../../resources/personal/js/calendar.js"></script> 
            <script src="../../resources/personal/js/table.js"></script> 
            
            <!--- tabla -->
            <link href="../../resources/personal/js/datatable/datatables.min.css" rel="stylesheet" type="text/css"/>
            <script src="../../resources/personal/js/datatable/datatables.min.js" type="text/javascript"></script>
            
            <link href="../../resources/template/css/plugins/datapicker/datepicker3.css" rel="stylesheet" type="text/css"/>
            <link href="../../resources/template/css/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet" type="text/css"/>
            <link href="../../resources/template/css/plugins/clockpicker/clockpicker.css" rel="stylesheet" type="text/css"/>

            <!-- Chart canva personal -->
            <link href="../../resources/personal/css/canvas/canvas.css" rel="stylesheet" type="text/css"/>            
            
            <div class="wrapper wrapper-content">
                <f:event type="postAddToView" listener="#{metasCobranzaBean.listarAnios()}"  />
                <f:event type="postAddToView" listener="#{metasCobranzaBean.listarMes()}"  />
                <f:event type="postAddToView" listener="#{metasCobranzaBean.listarAsesorUser()}"  />
                <f:event type="postAddToView" listener="#{metasCobranzaBean.listarFondosUser()}"  />
                
                <!--<f:event type="preRenderView" listener=" {depositoBean.actualizarDepositos()}" />-->
                <!--<f:event type="preRenderView" listener=" {personaBean.listartPersona()}" />-->
                <!--<f:event type="preRenderView" listener=" {dashboardBean.cargarGrafico()}" />-->
                
                <!-- Filas--> 
                <!--<div class="wrapper wrapper-content animated fadeInRight">-->
                <form jsf:id="formDeudorBusq" >
                    <!-- Filtros-->
                    <div class="row">
                        <!-- Filtros-->
                        <div class="col-lg-12">
                            <div class="ibox">
                                <div class="ibox-title">
                                    <h5>
                                        Filtros
                                        <small>Buscar metas de asesores</small>
                                    </h5>
                                </div>
                                <div class="ibox-content">
                                    <!-- Fila 03 Filtros -->
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="font-noraml">Año</label>
                                                <div class="input-group">
                                                    <h:selectOneMenu value="#{metasCobranzaBean.cobCronogramaMetaResumen.n_anio}" class="form-control m-b">
                                                        <f:selectItem itemLabel="Seleccionar" noSelectionOption="true" />
                                                        <f:selectItems value="#{metasCobranzaBean.maeAnioList}"  var="anios" itemValue="#{anios.CAnioId}"  itemLabel="#{anios.DAnio}" />
                                                    </h:selectOneMenu>	
                                                </div>
                                            </div>
                                        </div>                                        
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="font-noraml">Mes</label>
                                                <div class="input-group">
                                                    <h:selectOneMenu value="#{metasCobranzaBean.cobCronogramaMetaResumen.n_mes}" class="form-control m-b">
                                                        <f:selectItem itemLabel="Seleccionar" noSelectionOption="true" />
                                                        <f:selectItems value="#{metasCobranzaBean.maeMesList}"  var="mes" itemValue="#{mes.CMesId}"  itemLabel="#{mes.DMes}" />
                                                    </h:selectOneMenu>	
                                                </div>
                                            </div>
                                        </div> 
                                        <div class="col-sm-3">
                                                <div id="divRangoFechaB" class="form-group">
                                                    <label class="font-noraml">Fecha avance</label>
                                                    <div id="datepicker" class="input-daterange input-group">
                                                        <span class="input-group-addon">Día</span>
                                                        <h:inputText class="input-sm form-control" id="start" value="#{metasCobranzaBean.cobCronogramaMetaResumen.f_fecha_id}" >
                                                                <f:convertDateTime pattern="dd/MM/yyyy" />
                                                        </h:inputText>
                                                    </div>
                                                </div>
                                            </div>
                                    </div>
                                    <div class="row">                                            
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="font-noraml">Gestor:</label>
                                                <div class="input-group">
                                                    <h:selectOneMenu value="#{metasCobranzaBean.cobCronogramaMetaResumen.c_usuario_id}" class="form-control m-b">

                                                        <f:selectItems value="#{metasCobranzaBean.maeAsesorList}" var="asesor" itemValue="#{asesor.cusuarioId}"  itemLabel="#{asesor.dnombre}" />
                                                    </h:selectOneMenu>	
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="font-noraml">Fondo:</label>
                                                <div class="input-group">
                                                    <h:selectOneMenu value="#{metasCobranzaBean.cobCronogramaMetaResumen.c_fondo_id}" class="form-control m-b">
                                                        
                                                        <f:selectItems value="#{metasCobranzaBean.maeFondoList}" var="fondo" itemValue="#{fondo.CFondoId}"  itemLabel="#{fondo.DFondo}" />
                                                    </h:selectOneMenu>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <span class="input-group-btn">
                                                <a jsf:id="linkBuscar" jsf:action="#{metasCobranzaBean.exportarRecaudo()}" class="btn btn-primary btn-block m-t">
                                                    <i class="fa fa-search"></i>
                                                    Buscar
                                                </a>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Fila 0001 -->
                    <div class="row">
                        <!-- Grafico -->
                        <div class="col-lg-12">
                            <div class="ibox float-e-margins">
                                <div class="ibox-content">
                                    <!-- Cabecera del Grafico -->
                                    <div>
                                        <h3 class="font-bold no-margins">
                                            Meta vs. Recaudo
                                        </h3>
                                    </div>
                                    <!-- Grafico y leyenda -->    
                                    <div class="m-t-sm">
                                        <div class="row">
                                            <!-- Grafico -->
                                            <div class="col-md-9">
                                                <div>
                                                    <canvas id="lineChart"></canvas>
                                                </div>
                                            </div>
                                            <!-- leyenda -->
                                            <div class="col-md-3">
                                                <ul class="stat-list m-t-lg">
                                                    <div class="table-responsive" style="position:relative;width: 270px;">
                                                        <table class="table table-striped table-bordered table-hover dataTables-cliente-deudor "  data-paging='false'>
                                                            <thead>
                                                                <tr>
                                                                    <th style="display: none;">ID</th>
                                                                    <th>Concepto</th>
                                                                    <th>Meta</th>                                                        
                                                                </tr>
                                                            </thead>
                                                            <tbody>                                        
                                                                <ui:repeat var="metas" value="#{metasCobranzaBean.cobCronogramaMetaAvanceList}" varStatus="metaS">
                                                                        <tr class="gradeA">
                                                                            <td style="display: none;">#{metas.i_id}</td>
                                                                            <td>#{metas.c_concepto}</td>            
                                                                            <td class="text-right">
                                                                                <h:outputLabel value="#{metas.i_total}" class="text-right">
                                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                                </h:outputLabel>
                                                                            </td>
                                                                        </tr>
                                                                </ui:repeat>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <script type="text/javascript">
                        var lineData = {
                                    labels:#{metasCobranzaBean.dashboardBean.data0},
                                    datasets: [
                                        {
                                            label: "Meta",
                                            backgroundColor: "rgba(50,153,187,1)",
                                            borderColor: "rgba(50,153,187,1)",
                                            pointBackgroundColor: "rgba(50,153,187,1)",
                                            pointBorderColor: "#fff",
                                            data:#{metasCobranzaBean.dashboardBean.dataA}
                                        },
                                        {
                                            label: "Recaudo",
                                            backgroundColor: "rgba(255,153,0,1)",
                                            borderColor: "rgba(255,153,0,1)",
                                            pointBackgroundColor: "rgba(255,153,0,1)",
                                            pointBorderColor: "#fff",
                                            data:#{metasCobranzaBean.dashboardBean.dataB}
                                        }
                                    ]
                                };

                            var lineOptions = {
                                    scaleShowGridLines: true,
                                    scaleGridLineColor: "rgba(0,0,0,.05)",
                                    scaleGridLineWidth: 1,
                                    bezierCurve: true,
                                    bezierCurveTension: 0.4,
                                    pointDot: true,
                                    pointDotRadius: 4,
                                    pointDotStrokeWidth: 1,
                                    pointHitDetectionRadius: 20,
                                    datasetStroke: true,
                                    datasetStrokeWidth: 2,
                                    datasetFill: true,
                                    responsive: true
                                };


                            //var ctx = document.getElementById("lineChart").getContext("2d");
                            var ctx = $("#lineChart").get(0).getContext("2d");
                            //var myNewChart = new Chart(ctx).Line(lineData, lineOptions);
                            Chart.defaults.scale.ticks.beginAtZero = true;

                            new Chart(ctx, {type: 'bar', data: lineData, options: lineOptions});
                    </script>
                </form> 
            </div>

                               
            <div jsf:id="demoIdAx">
                <script>

                    $('#divRangoFechaB .input-daterange').datepicker({
                        keyboardNavigation: false,
                        forceParse: false,
                        autoclose: true,
                        format: 'dd/mm/yyyy',
                        language: 'es',
                        todayBtn: "linked"
                    });

                </script>
            </div>
            
           


        </ui:define>

    </ui:composition>

</html>
