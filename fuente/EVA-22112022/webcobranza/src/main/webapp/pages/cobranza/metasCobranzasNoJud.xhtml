<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="es" 
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:o="http://omnifaces.org/ui"
      xmlns:of="http://omnifaces.org/functions"
      xmlns:pf="http://primefaces.org/ui">

    <ui:composition template="/resources/personal/plantillas/template.xhtml">
        <ui:define name="content">
            <!-- JS -->
            <script src="../../resources/template/js/jquery-3.3.1.min.js" type="text/javascript"></script>
            <script src="../../resources/template/js/bootstrap.min.js"></script>
            <!-- Custom and plugin javascript -->
            <script src="../../resources/template/js/inspinia.js"></script>
            <script src="../../resources/template/js/plugins/pace/pace.min.js"></script>
            <script src="../../resources/template/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
            <!-- Chosen -->
            <script src="../../resources/template/js/plugins/chosen/chosen.jquery.js"></script>
            <!-- JSKnob -->
            <script src="../../resources/template/js/plugins/jsKnob/jquery.knob.js"></script>
            <!-- Input Mask-->
            <script src="../../resources/template/js/plugins/jasny/jasny-bootstrap.min.js"></script>
            <!-- Data picker -->
            <script src="../../resources/template/js/plugins/datapicker/bootstrap-datepicker.js"></script>
            <!-- NouSlider -->
            <script src="../../resources/template/js/plugins/nouslider/jquery.nouislider.min.js"></script>
            <!-- Switchery -->
            <script src="../../resources/template/js/plugins/switchery/switchery.js"></script>
            <!-- IonRangeSlider -->
            <script src="../../resources/template/js/plugins/ionRangeSlider/ion.rangeSlider.min.js"></script>
            <!-- iCheck -->
            <script src="../../resources/template/js/plugins/iCheck/icheck.min.js"></script>
            <!-- MENU -->
            <script src="../../resources/template/js/plugins/metisMenu/jquery.metisMenu.js"></script>
            <!-- Color picker -->
            <script src="../../resources/template/js/plugins/colorpicker/bootstrap-colorpicker.min.js"></script>
            <!-- Clock picker -->
            <script src="../../resources/template/js/plugins/clockpicker/clockpicker.js"></script>
            <!-- Image cropper -->
            <script src="../../resources/template/js/plugins/cropper/cropper.min.js"></script>
            <!-- Date range use moment.js same as full calendar plugin -->
            <script src="../../resources/template/js/plugins/fullcalendar/moment.min.js"></script>
            <!-- Date range picker -->
            <script src="../../resources/template/js/plugins/daterangepicker/daterangepicker.js"></script>
            <!-- Select2 -->
            <script src="../../resources/template/js/plugins/select2/select2.full.min.js"></script>
            <!-- TouchSpin -->
            <script src="../../resources/template/js/plugins/touchspin/jquery.bootstrap-touchspin.min.js"></script>
            <!-- grafico personal -->
            <script src="../../resources/personal/js/calendar.js"></script> 
            <script src="../../resources/personal/js/table.js"></script> 
            <!--datatable-->          
            
            <!--<script src="../../resources/personal/js/datatable/datatables.min.js" type="text/javascript"></script>
            <link href="../../resources/personal/js/datatable/datatables.min.css" rel="stylesheet" type="text/css"/>-->
            <script src="../../resources/personal/js/datatable/1.10.19/js/jquery.dataTables.min.js" type="text/javascript"></script>
            <script src="../../resources/personal/js/datatable/rowgroup/1.1.0/js/dataTables.rowGroup.min.js" type="text/javascript"></script>
            <script type="text/javascript" src="../../resources/personal/js/datatable/scroller/2.0.0/js/dataTables.scroller.min.js"></script>
            <!--CSS-->
            <link rel="stylesheet" type="text/css" href="../../resources/personal/js/datatable/1.10.19/css/jquery.dataTables.min.css"/>
            <link rel="stylesheet" type="text/css" href="../../resources/personal/js/datatable/rowgroup/1.1.0/css/rowGroup.dataTables.min.css"/>
            <link rel="stylesheet" type="text/css" href="../../resources/personal/js/datatable/scroller/2.0.0/css/scroller.dataTables.min.css"/>
            <link href="../../resources/template/css/plugins/datapicker/datepicker3.css" rel="stylesheet"/>
            <link href="../../resources/template/css/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet"/>
            <link href="../../resources/template/css/plugins/clockpicker/clockpicker.css" rel="stylesheet"/>
            <!-- Toastr script -->
            <script src="../../resources/template/js/plugins/toastr/toastr.min.js"></script>
            <!-- Toastr style -->
            <link href="../../resources/template/css/plugins/toastr/toastr.min.css" rel="stylesheet"/>            
            
            <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css"/> 
            <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
            <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
            <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"></script>
            
            <f:event type="postAddToView" listener="#{metasCobranzaBean.listarAnios()}"  />
            <f:event type="postAddToView" listener="#{metasCobranzaBean.listarMes()}"  />
            <!-- Paginacion header -->
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10">
                    <h2>Clientes</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="index.xhtml">Inicio</a>
                        </li>
                        <li>
                            <a>Cobranza</a>
                        </li>
                        <li class="active">
                            <strong>Metas cobranza</strong>
                        </li>
                    </ol>
                </div>
            </div>

            <!-- Filas-->
            <div class="wrapper wrapper-content animated fadeInRight">
                <form jsf:id="formDeudorBusq" >
                    <!-- Filtros-->
                    <div class="row">
                        <!-- Filtros-->
                        <div class="col-lg-12">
                            <div class="ibox">
                                <div class="ibox-title">
                                    <h5>
                                        Filtros
                                        <small>Buscar metas de asesores</small>
                                    </h5>
                                </div>
                                <div class="ibox-content">
                                    <!-- Fila 03 Filtros -->
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="font-noraml">AÃ±o</label>
                                                <div class="input-group">
                                                    <h:selectOneMenu value="#{metasCobranzaBean.cobCronogramaMetaResumen.n_anio}" class="form-control m-b">
                                                        <f:selectItem itemLabel="Seleccionar" noSelectionOption="true" />
                                                        <f:selectItems value="#{metasCobranzaBean.maeAnioList}"  var="anios" itemValue="#{anios.CAnioId}"  itemLabel="#{anios.DAnio}" />
                                                    </h:selectOneMenu>	
                                                </div>
                                            </div>
                                        </div>                                        
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label class="font-noraml">Mes</label>
                                                <div class="input-group">
                                                    <h:selectOneMenu value="#{metasCobranzaBean.cobCronogramaMetaResumen.n_mes}" class="form-control m-b">
                                                        <f:selectItem itemLabel="Seleccionar" noSelectionOption="true" />
                                                        <f:selectItems value="#{metasCobranzaBean.maeMesList}"  var="mes" itemValue="#{mes.CMesId}"  itemLabel="#{mes.DMes}" />
                                                    </h:selectOneMenu>	
                                                </div>
                                            </div>
                                        </div>                                         
                                        <div class="col-md-2">
                                            <span class="input-group-btn">
                                                
                                                <a jsf:id="linkBuscar" jsf:action="#{metasCobranzaBean.buscarResumenMetasTodos()}" class="btn btn-primary btn-block m-t">
                                                    <i class="fa fa-search"></i>
                                                    Buscar
                                                </a>
                                            </span>                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form> 
                <!-- Detalle -->
                <!-- Fila 0002 -->
                <div class="row">
                    <div class="col-sm-12">
                        <div class="ibox">
                            <div class="ibox-title">
                                 <h5>
                                     No judiciales
                                </h5>
                            </div>
                            
                            <div class="ibox-content" id="tabNoJudiciales">
                                <form jsf:id="formHeadDetalle" >
                                <ul class="nav nav-tabs">
                                    <li onclick="resizeTbGrupfec0();" class="active">
                                        <a id="tabMetasxFondo" data-toggle="tab" href="#tab-1"><i class="fa fa-user"></i>Metas por fondo</a>
                                        <script>
                                            function resizeTbGrupfec0()
                                            {
                                                var p = $("#tabNoJudiciales");
                                                var t1=$('#tResultadoResumen2');
                                                setTimeout(function(){ if(t1.innerHeight()>0)
                                                                       {
                                                                            //p.innerHeight(t1.innerHeight()+142); 
                                                                            p.innerHeight(700); 
                                                                       }
                                                                     }, 200);
                                            }
                                        </script>                                        
                                    </li>
                                    <li onclick="resizeTbGrupfec1();" class="">
                                        <a data-toggle="tab" href="#tab-GrupFec1" id="tabAsesor1" class="nav nav-tabs-bottom">
                                            <i class="fa fa-calculator"></i>
                                            <ui:fragment rendered="#{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente1List.size()>0}">
                                                #{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente1List[0].c_usuario_id}
                                            </ui:fragment>
                                        </a>
                                        <script>
                                            function resizeTbGrupfec1()
                                            {
                                                var p = $("#tabNoJudiciales");
                                                var t1=$('#tgruFec1');
                                                setTimeout(function(){ if(t1.innerHeight()>0)
                                                                       {
                                                                            //p.innerHeight(t1.innerHeight()+142); 
                                                                            p.innerHeight(700); 
                                                                       }
                                                                       $(document).ready(function() {
                                                                            $('#tgruFec1').DataTable();
                                                                        } );
                                                                     }, 200);
                                            }
                                        </script>
                                    </li>
                                    <li onclick="resizeTbGrupfec2();" class="">
                                        <a data-toggle="tab" href="#tab-GrupFec2" class="nav nav-tabs-bottom">
                                            <i class="fa fa-calculator"></i>
                                            <ui:fragment rendered="#{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente2List.size()>0}">
                                                #{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente2List[1].c_usuario_id}
                                            </ui:fragment>
                                        </a>
                                        <script>
                                            function resizeTbGrupfec2()
                                            {
                                                var p = $("#tabNoJudiciales");
                                                var t2=$('#tgruFec2');
                                                setTimeout(function(){ if(t2.innerHeight()>0)
                                                                       {
                                                                            //p.innerHeight(t1.innerHeight()+142); 
                                                                            p.innerHeight(700); 
                                                                       }
                                                                        $(document).ready(function() {
                                                                            $('#tgruFec2').DataTable();
                                                                        } );                                                                        
                                                                     }, 200);
                                            }
                                        </script>                                        
                                    </li>
                                    
                                    <li onclick="resizeTbGrupfec3();" class="">
                                        <a data-toggle="tab" href="#tab-GrupFec3" class="nav nav-tabs-bottom">
                                            <i class="fa fa-calculator"></i>
                                            <ui:fragment rendered="#{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente3List.size()>0}">
                                                #{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente3List[0].c_usuario_id}
                                            </ui:fragment>
                                        </a>
                                        <script>
                                            //alert("resizeTbGrupfec3");
                                            function resizeTbGrupfec3()
                                            {
                                                var p = $("#tabNoJudiciales");
                                                var t3=$('#tgruFec3');
                                                setTimeout(function(){ if(t3.innerHeight()>0)
                                                                       {
                                                                            //p.innerHeight(t1.innerHeight()+142); 
                                                                            p.innerHeight(700); 
                                                                       }
                                                                        $(document).ready(function() {
                                                                            $('#tgruFec3').DataTable();
                                                                        } );                                                                        
                                                                     }, 200);
                                            }
                                        </script>                                        
                                    </li>
                                    
                                    <li class="">
                                        <a data-toggle="tab" id="tabhead" href="#tab-Det"><i class="fa fa-tty"></i> 
                                        
                                            <ui:fragment rendered="#{metasCobranzaBean.cobCronogramaMetaDetalleList.size()>0}">
                                                <b>#{metasCobranzaBean.cobCronogramaMetaDetalleList[0].c_usuario_id}</b>
                                            </ui:fragment>
                                            <ui:fragment rendered="#{metasCobranzaBean.cobCronogramaMetaDetalleList.size()>0}">
                                                <b> fecha:
                                                    <h:outputText value="#{metasCobranzaBean.cobCronogramaMetaDetalleList[0].f_pago}">
                                                    <f:convertDateTime pattern="dd/MM/yyyy" />
                                                    </h:outputText></b>
                                            </ui:fragment>
                                            
                                        </a>
                                    </li>                                         
                                </ul>
                                </form>
                                <div class="tab-content">
                                    <br/>
                                    <div id="tab-1" class="tab-pane active">
                                        <form jsf:id="formResultadoResumen" >
                                            <a id="linkAprobarMeta"                                
                                                class="btn btn-primary btn-block m-t" style="width: 150px; height: 33px;position: absolute; left: 650px;"
                                                onclick="jscallAprobarMeta();">
                                                <i class="fa fa-retweet"></i>
                                                Aprobar Meta
                                            </a>
                                            <script>
                                                function jscallAprobarMeta()
                                                {
                                                    var elem = document.getElementById('formDetalleAsignacionAsesor:linkAprobarMeta');
                                                    elem.click();
                                                }
                                            </script>
                                            <a id="linkExportarReporte" 
                                                class="btn btn-primary btn-block m-t" style="width: 150px; height: 33px;position: absolute; left: 450px; display: none"
                                                onclick="jscallExportarReporte();">
                                                <i class="fa fa-retweet"></i>
                                                Exportar Reporte
                                            </a>
                                            <script>
                                                function jscallExportarReporte()
                                                {
                                                    var elem = document.getElementById('formResultadoResumen:linkExportarReporte');
                                                    elem.click();
                                                }
                                            </script>
                                            
                                            <div class="table-responsive" style="position:relative;width: 400px;">   
                                             
                                                <table id="tResultadoResumen" class="table table-striped table-bordered table-hover dataTables-cliente-deudor "  data-paging='false' data-order='[[2, "asc"]]'>
                                                    <thead>
                                                        <tr>
                                                            <th>Fondo </th>
                                                            <th>Moneda </th>
                                                            <th style="text-align:right">Total</th>
                                                            <th style="text-align:right">Cant_TCH</th>
                                                            <th style="text-align:right;display:none">Col2</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    <ui:repeat var="resumen" value="#{metasCobranzaBean.cobCronogramaMetaResumenFondosList}" varStatus="inverS">
                                                        <tr>
                                                            <td>
                                                                <a jsf:action="#{metasCobranzaBean.buscarMetaAgrupxFechaAgentes(resumen)}" data-toggle="tab-Det" href="#" class="client-link">
                                                                    #{resumen.c_fondo_desc}
                                                                    <f:ajax execute="@this" render="formHeadDetalle formGrupFec1 formGrupFec2 formGrupFec3 formDetalleAsignacionAsesor formGoTabAsesor1 "/>
                                                                </a>                                                                
                                                            </td>
                                                            <td>#{resumen.moneda}</td>
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.i_total}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td>
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.n_cant_tchn}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                                </td>
                                                        </tr>
                                                    </ui:repeat>  
                                                    </tbody>
                                                </table>
                                            </div>
                                        </form>
                                        
                                        <form jsf:id="formResultadoResumen2" >                                            
                                            <div class="table-responsive" style="position:relative; top:10px; height:350px ">
                                                <table id="tResultadoResumen2" class="table table-striped table-bordered table-hover dataTables-cliente-deudor ">
                                                    <thead>
                                                        <tr>
                                                            <th>Fondo</th>
                                                            <th>Asesor</th>
                                                            <th>Moneda</th>
                                                            <th style="text-align:right">Cant. CÃ³digos</th>
                                                            <th style="text-align:right">Cuota del Mes</th>
                                                            <th style="text-align:right">Total atrasado</th>
                                                            <th style="text-align:right">Total otros</th>
                                                            <th style="text-align:right">Total</th>
                                                            <th style="text-align:right">%Asesor</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    <ui:repeat var="resumen" value="#{metasCobranzaBean.cobCronogramaMetaResumenFondoxAsesorList}" varStatus="inverS">
                                                        <tr>
                                                            <td>#{resumen.c_fondo_desc}</td>
                                                            <td>#{resumen.c_usuario_id}</td> 
                                                            <td>#{resumen.moneda}</td> 
                                                            
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.n_cant_tchn}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td>  
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.v_cuota}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td> 
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.v_total_atrasado}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td> 
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.v_total_otros}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td> 
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.v_total}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td>
                                                            <td class="text-right">
                                                                <h:outputLabel value="#{resumen.v_porcentajeAsesor}" class="text-right">
                                                                    <f:convertNumber  locale="en-ZA" currencySymbol="" groupingUsed="true" maxFractionDigits="2" type="currency" pattern="###,###.###" />
                                                                </h:outputLabel>
                                                            </td>                                                            
                                                        </tr>
                                                    </ui:repeat>  
                                                    </tbody>
                                                </table>                                                
                                                <div jsf:id="dshowResumen" rendered="#{metasCobranzaBean.showResumen}">
                                                <script>
                                                    
                                                    $(document).ready(function() {
                                                        $('#tResultadoResumen2').DataTable({
                                                                paging:   false,
                                                                ordering: false,
                                                                info:     false,
                                                                scrollY:  350,
                                                                scrollCollapse: true,
                                                                columnDefs: [
                                                                            {
                                                                                "targets": [ 0 ],
                                                                                "visible": false,
                                                                                "searchable": false
                                                                            }
                                                                            ],
                                                                rowGroup: {
                                                                    startRender: null,
                                                                    endRender: function ( rows, group ) {                                                                        
                                                                        var cantTchn = rows
                                                                            .data()
                                                                            .pluck(2)
                                                                            .reduce( function (a, b) {
                                                                                return a + b.replace(/[^\d]/g, '')*1;
                                                                            }, 0);
                                                                        cantTchn=cantTchn/1;
                                                                        cantTchn = $.fn.dataTable.render.number(',', '.', 0, '').display( cantTchn );
                                                                        
                                                                        var cuotaMes = rows
                                                                            .data()
                                                                            .pluck(3)
                                                                            .reduce( function (a, b) {
                                                                                return a + b.replace(/[^\d]/g, '')*1;
                                                                            }, 0);
                                                                        cuotaMes=cuotaMes/100;
                                                                        cuotaMes = $.fn.dataTable.render.number(',', '.', 2, '').display( cuotaMes );
                                                                        
                                                                        var totalAtrasado = rows
                                                                            .data()
                                                                            .pluck(4)
                                                                            .reduce( function (a, b) {
                                                                                return a + b.replace(/[^\d]/g, '')*1;
                                                                            }, 0);
                                                                        totalAtrasado=totalAtrasado/100;
                                                                        totalAtrasado = $.fn.dataTable.render.number(',', '.', 2, '').display( totalAtrasado );
                                                                        
                                                                        var totalOtros = rows
                                                                            .data()
                                                                            .pluck(5)   
                                                                            .reduce( function (a, b) {
                                                                                return a + b.replace(/[^\d]/g, '')*1;
                                                                            }, 0);
                                                                        totalOtros=totalOtros/100;
                                                                        totalOtros = $.fn.dataTable.render.number(',', '.', 2, '').display( totalOtros );
                                                                        
                                                                        var salaryAvg = rows
                                                                            .data()
                                                                            .pluck(6)
                                                                            .reduce( function (a, b) {
                                                                                return a + b.replace(/[^\d]/g, '')*1;
                                                                            }, 0);
                                                                        salaryAvg=salaryAvg/100;
                                                                        salaryAvg = $.fn.dataTable.render.number(',', '.', 2, '').display( salaryAvg );
                                                                        
                                                                        var porcentaje = rows
                                                                            .data()
                                                                            .pluck(7)
                                                                            .reduce( function (a, b) {
                                                                                return a + b.replace(/[^\d]/g, '')*1;
                                                                            }, 0);
                                                                        porcentaje=porcentaje/100;
                                                                        porcentaje = $.fn.dataTable.render.number(',', '.', 2, '').display( porcentaje );
                                                                      
                                                                        return $('<tr/>')
                                                                            .append( '<td> Total '+group+'</td>' )
                                                                            .append( '<td style="text-align:right">'+cantTchn+'</td>' )
                                                                            .append( '<td style="text-align:right">'+cuotaMes+'</td>' )
                                                                            .append( '<td style="text-align:right">'+totalAtrasado+'</td>' )                                                                            
                                                                            .append( '<td style="text-align:right">'+totalOtros+'</td>' ) 
                                                                            .append( '<td style="text-align:right">'+salaryAvg+'</td>' )
                                                                            .append( '<td style="text-align:right">'+porcentaje+'</td>' );
                                                                    },
                                                                    dom: 'Bfrtip',
                                                                    buttons: [
                                                                                'copyHtml5',
                                                                                'excelHtml5',
                                                                                'csvHtml5',
                                                                                'pdfHtml5'
                                                                                ],
                                                                    dataSrc: 0
                                                                }
                                                            });
                                                        });
                                                    
                                                    var p = $( "#tabNoJudiciales" );
                                                    var t2=$('#tResultadoResumen2');
                                                    p.innerHeight(700);
                                                </script>
                                                </div>
                                            </div>
                                        </form>                                        
                                    </div>
                                    
                                <div id="tab-GrupFec1" class="tab-pane">
                                       <form jsf:id="formGrupFec1" >
                                            <div class="table-responsive">
                                                <table id="tgruFec1" class="table table-striped table-bordered table-hover dataTables-cliente-deudor" data-page-length="10">
                                                    <thead>
                                                        <tr>
                                                            <th>Fecha</th>
                                                            <th>Moneda</th>
                                                            <th>Nro. Codigos</th>
                                                            <th>Cuota Mensual.</th>
                                                            <th>Total Atrasado</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    <ui:repeat var="gruFec1" value="#{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente1List}" varStatus="inverS" >
                                                        <tr>
                                                            <td>
                                                                <a jsf:action="#{metasCobranzaBean.buscarAsesoresAsignadosCodigosDetalle(gruFec1)}" data-toggle="tab-Det" href="#" class="client-link">
                                                                    #{gruFec1.fecha}
                                                                    <f:ajax execute="@this" render="formDetalleAsignacionAsesor formHeadDetalle"/>
                                                                </a>
                                                            </td>                         
                                                            <td>#{gruFec1.moneda}</td>
                                                            <td>#{gruFec1.nroCodigos}</td>
                                                            <td>#{gruFec1.cuotaMes}</td>
                                                            <td>#{gruFec1.totalAtrasado}</td>
                                                        </tr>
                                                    </ui:repeat>  
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div jsf:id="tShowAsesorGroupFecha1" rendered="#{metasCobranzaBean.showAsesorGroupFecha1}">
                                                 <script>
                                                    // alert("4");
                                                    $(document).ready(function() {
                                                         $('#tgruFec1').DataTable(
                                                                {
                                                                        dom: 'Bfrtip',
                                                                        buttons: [
                                                                                'copyHtml5',
                                                                                'excelHtml5',
                                                                                'csvHtml5',
                                                                                'pdfHtml5'
                                                                                ]
                                                                } );
                                                    });
                                                 </script>
                                             </div>
                                        </form>                                    
                                </div>                                
                                                                
                                <div id="tab-GrupFec2" class="tab-pane ">
                                       <form jsf:id="formGrupFec2" >
                                            <div class="table-responsive">
                                                <table id="tgruFec2" class="table table-striped table-bordered table-hover dataTables-cliente-deudor"  data-page-length="10">
                                                    <thead>
                                                        <tr>
                                                            <th>Fecha</th>
                                                            <th>Moneda</th>
                                                            <th>Nro. Codigos</th>
                                                            <th>Cuota Mensual.</th>
                                                            <th>Total Atrasado</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    <ui:repeat var="gruFec2" value="#{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente2List}" varStatus="inverS">
                                                        <tr>
                                                            <td>
                                                                <a jsf:action="#{metasCobranzaBean.buscarAsesoresAsignadosCodigosDetalle(gruFec2)}" data-toggle="tab-Det" href="#" class="client-link">
                                                                    #{gruFec2.fecha}
                                                                    <f:ajax execute="@this" render="formDetalleAsignacionAsesor formHeadDetalle"/>
                                                                </a>
                                                            </td>     
                                                            <td>#{gruFec2.moneda}</td> 
                                                            <td>#{gruFec2.nroCodigos}</td>
                                                            <td>#{gruFec2.cuotaMes}</td>
                                                            <td>#{gruFec2.totalAtrasado}</td>
                                                        </tr>
                                                    </ui:repeat>  
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div jsf:id="tShowAsesorGroupFecha2" rendered="#{metasCobranzaBean.showAsesorGroupFecha2}">
                                                 <script>
                                                    // alert("5");
                                                    $(document).ready(function() {
                                                         $('#tgruFec2').DataTable( {
                                                                            dom: 'Bfrtip',
                                                                            buttons: [
                                                                                    'copyHtml5',
                                                                                    'excelHtml5',
                                                                                    'csvHtml5',
                                                                                    'pdfHtml5'
                                                                                     ]
                                                                    } );
                                                    } );
                                                 </script>
                                             </div>                                           
                                        </form>                                    
                                 </div>                                
                                
                                <div id="tab-GrupFec3" class="tab-pane ">
                                       <form jsf:id="formGrupFec3" >
                                            <div class="table-responsive">
                                                <table id="tgruFec3" class="table table-striped table-bordered table-hover dataTables-cliente-deudor"  data-page-length="10">
                                                    <thead>
                                                        <tr>
                                                            <th>Fecha</th>
                                                            <th>Moneda</th>
                                                            <th>Nro. Codigos</th>
                                                            <th>Cuota Mensual.</th>
                                                            <th>Total Atrasado</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    <ui:repeat var="gruFec3" value="#{metasCobranzaBean.cobCronogramaMetaAgrupxFechaAgente3List}" varStatus="inverS">
                                                        <tr>
                                                            <td>
                                                                <a jsf:action="#{metasCobranzaBean.buscarAsesoresAsignadosCodigosDetalle(gruFec3)}" data-toggle="tab-Det" href="#" class="client-link">
                                                                    #{gruFec3.fecha}
                                                                    <f:ajax execute="@this" render="formDetalleAsignacionAsesor formHeadDetalle"/>
                                                                </a>
                                                            </td>     
                                                            <th>#{gruFec3.moneda}</th>
                                                            <td>#{gruFec3.nroCodigos}</td>
                                                            <td>#{gruFec3.cuotaMes}</td>
                                                            <td>#{gruFec3.totalAtrasado}</td>
                                                        </tr>
                                                    </ui:repeat>  
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div jsf:id="tShowAsesorGroupFecha3" rendered="#{metasCobranzaBean.showAsesorGroupFecha3}">
                                                 <script>
                                                    // alert("5");
                                                    $(document).ready(function() {
                                                         $('#tgruFec3').DataTable( {
                                                                            dom: 'Bfrtip',
                                                                            buttons: [
                                                                                    'copyHtml5',
                                                                                    'excelHtml5',
                                                                                    'csvHtml5',
                                                                                    'pdfHtml5'
                                                                                     ]
                                                                    } );
                                                    } );
                                                 </script>
                                             </div>                                           
                                        </form>                                    
                                </div>   
                                    
                                <div id="tab-Det" class="tab-pane ">
                                       <form jsf:id="formDetalleAsignacionAsesor" >
                                            <a jsf:id="linkCambiarAsesorHd" jsf:action="#{metasCobranzaBean.cambiarAsesoresACodigos()}" 
                                               class="btn btn-primary btn-block m-t" style="display: none">
                                                <f:ajax execute="formDetalleAsignacionAsesor" render="formDetalleAsignacionAsesor" />
                                            </a>
                                           
                                           <a jsf:id="linkAprobarMeta" jsf:action="#{metasCobranzaBean.aprobarMetasTodas()}" 
                                                class="btn btn-primary btn-block m-t" style="display: none">
                                                <f:ajax execute="formDetalleAsignacionAsesor" render="msgDoc" />
                                            </a>
                                           
                                           <a jsf:id="linkExportarReporte" jsf:action="#{metasCobranzaBean.cambiarAsesoresACodigos()}" 
                                               class="btn btn-primary btn-block m-t" style="display: none">
                                                <f:ajax execute="formDetalleAsignacionAsesor" render="formDetalleAsignacionAsesor" />
                                            </a>
                                           
                                           <div jsf:id="msgDoc" jsf:name="msgDoc"> 
                                                <div jsf:rendered="#{metasCobranzaBean.showMsg}">
                                                    <script type="text/javascript">
                                                        toastr.options = {
                                                            "closeButton": true,
                                                            "debug": false,
                                                            "progressBar": true,
                                                            "preventDuplicates": false,
                                                            "positionClass": "toast-top-right",
                                                            "onclick": null,
                                                            "showDuration": "400",
                                                            "hideDuration": "1000",
                                                            "timeOut": "7000",
                                                            "extendedTimeOut": "1000",
                                                            "showEasing": "swing",
                                                            "hideEasing": "linear",
                                                            "showMethod": "fadeIn",
                                                            "hideMethod": "fadeOut"
                                                        };
                                                        toastr.#{metasCobranzaBean.tipoMsj}('#{metasCobranzaBean.mensaje}', 'Mensaje');
                                                        
                                                        document.all.tabhead.click();
                                                        $(document).ready(function() {
                                                             $('#tCodsDeta').DataTable(
                                                                      {
                                                                             dom: 'Bfrtip',
                                                                             buttons: [
                                                                                         'copyHtml5',
                                                                                         'excelHtml5',
                                                                                         'csvHtml5',
                                                                                         'pdfHtml5'
                                                                                      ]
                                                                     } );
                                                         } );
                                                    </script>
                                                </div>
                                            </div>
                                           
                                            <div class="table-responsive">
                                                <table id="tCodsDeta" class="table table-striped table-bordered table-hover dataTables-cliente-deudor" data-page-length="10">
                                                    <thead>
                                                        <tr>
                                                            <th></th>
                                                            <th>Codigo</th>
                                                            <th>Moneda</th>
                                                            <th>F.Pago</th>
                                                            <th>N.Ct.A.</th>
                                                            <th>Moneda</th>
                                                            <th>Mont.Cuota</th>
                                                            <th>Mont.Capital</th>
                                                            <th>Mont.Interes</th>
                                                            <th>Sal.Capital</th>
                                                            <th>Sal.Interes</th>
                                                            <th>Mora</th>
                                                            <th>Tot.Atrasado</th>
                                                            <th>Dia</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                    <ui:repeat var="det" value="#{metasCobranzaBean.cobCronogramaMetaDetalleList}" varStatus="inverS">
                                                        <tr>
                                                            <td><h:selectBooleanCheckbox value="#{det.selected}"/></td>
                                                            <td>#{det.c_inversion}</td>                                                             
                                                            <td>#{det.moneda}</td>
                                                            <td>
                                                                <h:outputText value="#{det.f_pago}">
                                                                 <f:convertDateTime pattern="dd/MM/yyyy" />
                                                                </h:outputText>
                                                            </td>
                                                            <td>#{det.n_cuota_atrasada}</td>
                                                            <td>#{det.moneda}</td>
                                                            <td>#{det.i_cuota}</td>
                                                            <td>#{det.i_capital}</td>
                                                            <td>#{det.i_interes}</td>
                                                            <td>#{det.i_capital_atrasado}</td>
                                                            <td>#{det.i_interes_atrasado}</td>
                                                            <td>#{det.i_mora_atrasado}</td>
                                                            <td>#{det.i_total_atrasado}</td>
                                                            <td>#{det.n_dia}</td>
                                                        </tr>
                                                    </ui:repeat>  
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div jsf:id="showTabDet" rendered="#{metasCobranzaBean.showGoDeta}">
                                                <script>
                                                   // alert("6");
                                                   document.all.tabhead.click();
                                                   $(document).ready(function() {
                                                        $('#tCodsDeta').DataTable(
                                                                 {
                                                                        dom: 'Bfrtip',
                                                                        buttons: [
                                                                                    'copyHtml5',
                                                                                    'excelHtml5',
                                                                                    'csvHtml5',
                                                                                    'pdfHtml5'
                                                                                 ]
                                                                } );
                                                    } );
                                                </script>
                                            </div>
                                           <div jsf:id="refreshResYGroup" rendered="#{metasCobranzaBean.showRefreshResumenyGruposFecha}">
                                                <script>
                                                    //alert("7");
                                                     //alert("showRefreshResumenyGruposFecha");
                                                     var elem = document.getElementById('formActualizar:linkActualizar');
                                                     //alert("linkActualizar");
                                                     //alert(elem.id);
                                                     elem.click();
                                                </script>
                                            </div>                                           
                                        </form>
                                        <form jsf:id="formCambiarAsesor" >
                                            <a id="linkCambiarAsesor" 
                                                class="btn btn-primary btn-block m-t" style="width: 150px; height: 33px;position: absolute; left: 250px; top: 100px;"
                                                onclick="jscallCambiarAsesor();">
                                                <i class="fa fa-retweet"></i>
                                                Cambiar Asesor
                                            </a>
                                            <script>
                                                function jscallCambiarAsesor()
                                                {
                                                    var elem = document.getElementById('formDetalleAsignacionAsesor:linkCambiarAsesorHd');
                                                    elem.click();
                                                }
                                            </script>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Detalle -->
                <!-- Fila 0004 -->
                
            </div>  

            <div jsf:id="demoIdAx">
                <script>
                    $(document).ready(function () {
                        $(".touchspin1").TouchSpin({
                            buttondown_class: 'btn btn-white',
                            buttonup_class: 'btn btn-white'
                        });
                    });

                    $('#data_1 .input-group.date').datepicker({
                        timePicker: true,
                        timePickerIncrement: 30,
                        startDate: '01/01/2000',
                        endDate: '01/01/2030',
                        format: 'dd/mm/yyyy',
                        language: 'es',
                        autoclose: true,
                        todayBtn: "linked"
                    });

                    $('.fullscreen-link').click(function () {
                        var ibox = $(this).closest('div.ibox');
                        var button = $(this).find('i');
                        $('body').toggleClass('fullscreen-ibox-mode');
                        button.toggleClass('fa-expand').toggleClass('fa-compress');
                        ibox.toggleClass('fullscreen');
                        setTimeout(function () {
                            $(window).trigger('resize');
                        }, 100);
                    });
                    $('.full-height-scroll').slimscroll({
                        height: '100%'
                    });
                    // $('.footable').footable();
                    // $('.footable2').footable();
                    $('.clockpicker').clockpicker();
                    // Tooltips demo
                    $('.tooltip-demo').tooltip({
                        selector: "[data-toggle=tooltip]",
                        container: "body"
                    });
                </script>
            </div>

            <form jsf:id="formGoTabAsesor1" style="display:none">
                <div jsf:id="dvGoTabAsesor1" rendered="#{metasCobranzaBean.showGoTabAsesor1}">
                     <script>
                         //alert("8");
                         //document.all.tabAsesor1.click();
                         var elem = document.getElementById('tabAsesor1');
                         elem.click();
                     </script>
                 </div>                                                               
            </form>
            <form jsf:id="formActualizar" style="display:none">
                  <a jsf:id="linkActualizar" jsf:action="#{metasCobranzaBean.refrescarTablas()}" 
                    class="btn btn-primary btn-block m-t" style="width: 150px; height: 33px;position: relative; left: 450px;">
                     <f:ajax execute="formActualizar" render="formResultadoResumen formResultadoResumen2 formGrupFec1 formGrupFec2 formGrupFec3 formActualizar " />
                     <i class="fa fa-retweet"></i>
                     actualizar
                 </a>               
                <div jsf:id="refreshTables" rendered="#{metasCobranzaBean.showRefreshTables}">
                     <script>
                         //alert("9");
                         document.all.tabMetasxFondo.click();
                        //alert("call linkActualizar: showRefreshTables");
                        /*$(document).ready(function() {
                             $('#tResultadoResumen').DataTable();
                        } );
                        $(document).ready(function() {
                             $('#tCodsDeta').DataTable();
                         } );
                        $(document).ready(function() {
                             $('#tgruFec1').DataTable();
                         } );
                        $(document).ready(function() {
                             $('#tgruFec2').DataTable();
                         } );*/
                     </script>
                 </div>                                                               
            </form>            
            
            <script>
                $(document).ready(function () {
                    $(".touchspin1").TouchSpin({
                        buttondown_class: 'btn btn-white',
                        buttonup_class: 'btn btn-white'
                    });
                    $('.clockpicker').clockpicker();
                });

            </script>
        </ui:define>

    </ui:composition> 

</html>